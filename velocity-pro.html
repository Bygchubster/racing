<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Velocity Pro – Time Trial Racer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #0b0f1a;
    font-family: system-ui, sans-serif;
    overflow: hidden;
    color: white;
  }

  canvas {
    display: block;
    margin: 0 auto;
    background: linear-gradient(#1a1f3a, #05070f);
  }

  #hud {
    position: absolute;
    top: 12px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 24px;
    font-size: 16px;
    font-weight: 600;
  }

  #hud span {
    background: rgba(0,0,0,0.5);
    padding: 6px 12px;
    border-radius: 8px;
  }

  #help {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 12px;
    opacity: 0.6;
  }
</style>
</head>

<body>
<canvas id="game" width="800" height="500"></canvas>

<div id="hud">
  <span id="speed">Speed: 0</span>
  <span id="time">Time: 0.00s</span>
</div>

<div id="help">
  ↑ Accelerate · ↓ Brake · ← → Steer · R Restart
</div>

<script>
/* ===========================
   CONFIG / CONSTANTS
=========================== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const ROAD_WIDTH = 260;
const MAX_SPEED = 12;
const ACCELERATION = 0.15;
const BRAKE_FORCE = 0.25;
const FRICTION = 0.04;
const STEER_FORCE = 0.04;

/* ===========================
   GAME STATE
=========================== */
let keys = {};
let startTime = performance.now();
let elapsedTime = 0;

const car = {
  x: canvas.width / 2,
  y: canvas.height - 120,
  width: 24,
  height: 48,
  speed: 0,
  angle: 0
};

let roadOffset = 0;

/* ===========================
   INPUT
=========================== */
window.addEventListener("keydown", e => {
  keys[e.key.toLowerCase()] = true;

  if (e.key.toLowerCase() === "r") resetGame();
});

window.addEventListener("keyup", e => {
  keys[e.key.toLowerCase()] = false;
});

/* ===========================
   GAME LOGIC
=========================== */
function resetGame() {
  car.speed = 0;
  car.angle = 0;
  car.x = canvas.width / 2;
  startTime = performance.now();
}

function update(delta) {
  // Acceleration
  if (keys["arrowup"] || keys["w"]) {
    car.speed += ACCELERATION;
  }

  // Braking
  if (keys["arrowdown"] || keys["s"]) {
    car.speed -= BRAKE_FORCE;
  }

  // Steering
  if (keys["arrowleft"] || keys["a"]) {
    car.angle -= STEER_FORCE * (car.speed / MAX_SPEED);
  }

  if (keys["arrowright"] || keys["d"]) {
    car.angle += STEER_FORCE * (car.speed / MAX_SPEED);
  }

  // Clamp speed
  car.speed = Math.max(0, Math.min(MAX_SPEED, car.speed));

  // Friction
  car.speed -= FRICTION;
  if (car.speed < 0) car.speed = 0;

  // Movement
  car.x += Math.sin(car.angle) * car.speed;
  roadOffset += car.speed * 2;

  // Road boundaries
  const left = canvas.width / 2 - ROAD_WIDTH / 2;
  const right = canvas.width / 2 + ROAD_WIDTH / 2;

  if (car.x < left + car.width / 2) car.x = left + car.width / 2;
  if (car.x > right - car.width / 2) car.x = right - car.width / 2;

  // Time
  elapsedTime = (performance.now() - startTime) / 1000;
}

/* ===========================
   RENDERING
=========================== */
function drawRoad() {
  ctx.fillStyle = "#222";
  ctx.fillRect(
    canvas.width / 2 - ROAD_WIDTH / 2,
    0,
    ROAD_WIDTH,
    canvas.height
  );

  // Center line
  ctx.strokeStyle = "#fff";
  ctx.lineWidth = 4;
  ctx.setLineDash([20, 20]);
  ctx.lineDashOffset = -roadOffset;

  ctx.beginPath();
  ctx.moveTo(canvas.width / 2, 0);
  ctx.lineTo(canvas.width / 2, canvas.height);
  ctx.stroke();
  ctx.setLineDash([]);
}

function drawCar() {
  ctx.save();
  ctx.translate(car.x, car.y);
  ctx.rotate(car.angle);

  ctx.fillStyle = "#ff2d2d";
  ctx.fillRect(
    -car.width / 2,
    -car.height / 2,
    car.width,
    car.height
  );

  // Windshield
  ctx.fillStyle = "#111";
  ctx.fillRect(-8, -18, 16, 10);

  ctx.restore();
}

function drawHUD() {
  document.getElementById("speed").textContent =
    "Speed: " + Math.round(car.speed * 10);

  document.getElementById("time").textContent =
    "Time: " + elapsedTime.toFixed(2) + "s";
}

function render() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawRoad();
  drawCar();
  drawHUD();
}

/* ===========================
   GAME LOOP
=========================== */
let lastTime = performance.now();

function loop(time) {
  const delta = time - lastTime;
  lastTime = time;

  update(delta);
  render();

  requestAnimationFrame(loop);
}

requestAnimationFrame(loop);
</script>
</body>
</html>
